<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Federated Healthcare AI | Neural Federation Interface</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ff94;
            --secondary: #00d4ff;
            --accent: #7c3aed;
            --warning: #ffb800;
            --danger: #ff3366;
            --success: #00ff94;
            --dark: #0a0a0f;
            --darker: #050507;
            --surface: rgba(255, 255, 255, 0.03);
            --surface-2: rgba(255, 255, 255, 0.06);
            --surface-3: rgba(255, 255, 255, 0.09);
            --text: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.7);
            --text-subtle: rgba(255, 255, 255, 0.5);
            --border: rgba(255, 255, 255, 0.1);
            --glow-primary: 0 0 30px rgba(0, 255, 148, 0.3);
            --glow-secondary: 0 0 30px rgba(0, 212, 255, 0.3);
            --federation-gradient: linear-gradient(135deg, #00ff94 0%, #00d4ff 50%, #7c3aed 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--darker);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Dynamic mesh background for healthcare theme */
        .bg-healthcare {
            position: fixed;
            inset: 0;
            z-index: -2;
            background: 
                radial-gradient(circle at 25% 25%, rgba(0, 255, 148, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(0, 212, 255, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 10%, rgba(124, 58, 237, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 10% 90%, rgba(0, 255, 148, 0.06) 0%, transparent 50%);
            animation: healthcareFloat 25s ease-in-out infinite;
        }

        @keyframes healthcareFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, -20px) rotate(90deg); }
            50% { transform: translate(-10px, 30px) rotate(180deg); }
            75% { transform: translate(30px, 10px) rotate(270deg); }
        }

        /* Medical cross pattern overlay */
        .medical-grid {
            position: fixed;
            inset: 0;
            z-index: -1;
            opacity: 0.03;
            background-image: 
                linear-gradient(rgba(0, 255, 148, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 148, 0.2) 1px, transparent 1px),
                linear-gradient(rgba(0, 212, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 212, 255, 0.1) 1px, transparent 1px);
            background-size: 100px 100px, 100px 100px, 20px 20px, 20px 20px;
            animation: gridPulse 6s ease-in-out infinite;
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.03; }
            50% { opacity: 0.08; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
        }

        /* Header with medical theme */
        .header {
            text-align: center;
            margin-bottom: 4rem;
            position: relative;
        }

        .federation-logo {
            width: 140px;
            height: 140px;
            margin: 0 auto 2rem;
            background: var(--federation-gradient);
            border-radius: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: var(--glow-primary);
            animation: federationPulse 4s ease-in-out infinite;
        }

        .federation-logo::before {
            content: '';
            position: absolute;
            inset: -3px;
            background: var(--federation-gradient);
            border-radius: 38px;
            z-index: -1;
            animation: borderGlow 6s linear infinite;
        }

        @keyframes federationPulse {
            0%, 100% { transform: scale(1); box-shadow: var(--glow-primary); }
            50% { transform: scale(1.05); box-shadow: var(--glow-secondary); }
        }

        @keyframes borderGlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        .main-title {
            font-size: clamp(2.8rem, 6vw, 4.5rem);
            font-weight: 800;
            background: var(--federation-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            line-height: 1.1;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
            font-weight: 300;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--surface-2);
            border: 1px solid rgba(0, 255, 148, 0.3);
            border-radius: 50px;
            color: var(--primary);
            font-size: 0.9rem;
            font-weight: 500;
            backdrop-filter: blur(20px);
            box-shadow: var(--glow-primary);
        }

        /* Main dashboard layout */
        .dashboard {
            display: grid;
            grid-template-columns: 350px 1fr 350px;
            gap: 2rem;
            align-items: start;
            margin-bottom: 3rem;
        }

        .panel {
            background: var(--surface);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .panel::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(0, 255, 148, 0.03) 0%, rgba(0, 212, 255, 0.03) 100%);
            border-radius: 24px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .panel:hover::before {
            opacity: 1;
        }

        .panel-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text);
        }

        .panel-icon {
            width: 28px;
            height: 28px;
            background: var(--federation-gradient);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        /* Federation simulation controls */
        .simulation-controls {
            margin-bottom: 2rem;
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
        }

        .slider-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .slider {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 255, 148, 0.5);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(0, 255, 148, 0.5);
        }

        .slider-value {
            position: absolute;
            right: 0;
            top: -25px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 600;
        }

        /* Institution cards */
        .institutions-grid {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .institution-card {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .institution-card:hover {
            background: var(--surface-3);
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .institution-card.active {
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(0, 255, 148, 0.2);
        }

        .institution-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .institution-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .institution-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .institution-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Central visualization */
        .federation-viz {
            min-height: 500px;
            position: relative;
        }

        .viz-container {
            width: 100%;
            height: 100%;
            background: var(--surface-2);
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }

        .viz-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .viz-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .viz-controls {
            display: flex;
            gap: 0.5rem;
        }

        .viz-btn {
            padding: 0.5rem 1rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .viz-btn:hover, .viz-btn.active {
            background: var(--primary);
            color: var(--dark);
            border-color: var(--primary);
        }

        /* Network visualization */
        .network-svg {
            width: 100%;
            height: 400px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            overflow: hidden;
        }

        /* Performance metrics */
        .metrics-grid {
            display: grid;
            gap: 1rem;
        }

        .metric-card {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            background: var(--surface-3);
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--federation-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .metric-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .metric-trend {
            font-size: 0.75rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        /* Federation controls */
        .federation-controls {
            display: grid;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--federation-gradient);
            color: white;
            box-shadow: var(--glow-primary);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 148, 0.4);
        }

        .btn-secondary {
            background: var(--surface-2);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--surface-3);
            border-color: var(--primary);
        }

        .btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .btn:hover::before {
            transform: translateX(100%);
        }

        /* Loading and status indicators */
        .training-status {
            display: none;
            text-align: center;
            padding: 2rem;
            background: var(--surface-2);
            border-radius: 16px;
            margin: 2rem 0;
        }

        .federation-loader {
            width: 100px;
            height: 100px;
            margin: 0 auto 1.5rem;
            position: relative;
        }

        .loader-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-radius: 50%;
            animation: federationSpin 2s linear infinite;
        }

        .loader-ring:nth-child(1) {
            border-top: 3px solid var(--primary);
            animation-duration: 2s;
        }

        .loader-ring:nth-child(2) {
            width: 75%;
            height: 75%;
            top: 12.5%;
            left: 12.5%;
            border-top: 3px solid var(--secondary);
            animation-duration: 1.5s;
            animation-direction: reverse;
        }

        .loader-ring:nth-child(3) {
            width: 50%;
            height: 50%;
            top: 25%;
            left: 25%;
            border-top: 3px solid var(--accent);
            animation-duration: 1s;
        }

        @keyframes federationSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Privacy indicators */
        .privacy-status {
            background: var(--surface-2);
            border: 1px solid rgba(0, 255, 148, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .privacy-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .privacy-icon {
            width: 24px;
            height: 24px;
            background: var(--primary);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .privacy-items {
            display: grid;
            gap: 0.75rem;
        }

        .privacy-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .privacy-check {
            width: 16px;
            height: 16px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 4rem;
            padding: 2rem 0;
            border-top: 1px solid var(--border);
        }

        .architecture-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: var(--federation-gradient);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--glow-primary);
        }

        .architecture-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 255, 148, 0.4);
        }

        /* Responsive design */
        @media (max-width: 1400px) {
            .dashboard {
                grid-template-columns: 300px 1fr 300px;
            }
        }

        @media (max-width: 1024px) {
            .dashboard {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .container {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 2.5rem;
            }
            
            .panel {
                padding: 1.5rem;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="bg-healthcare"></div>
    <div class="medical-grid"></div>
    
    <div class="container">
        <header class="header">
            <div class="federation-logo">
                <svg width="80" height="80" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <!-- Central node -->
                    <circle cx="60" cy="60" r="12" fill="white" opacity="0.9"/>
                    
                    <!-- Institution nodes -->
                    <circle cx="30" cy="30" r="8" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.4;0.9;0.4" dur="3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="90" cy="30" r="8" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.9;0.4;0.9" dur="3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="30" cy="90" r="8" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.7;0.4;0.7" dur="3s" repeatCount="indefinite"/>
                    </circle>
                    <circle cx="90" cy="90" r="8" fill="white" opacity="0.7">
                        <animate attributeName="opacity" values="0.4;0.7;0.4" dur="3s" repeatCount="indefinite"/>
                    </circle>
                    
                    <!-- Connections -->
                    <g stroke="white" stroke-width="2" opacity="0.6">
                        <line x1="30" y1="30" x2="60" y2="60" stroke-dasharray="5,5">
                            <animate attributeName="stroke-dashoffset" values="0;10" dur="2s" repeatCount="indefinite"/>
                        </line>
                        <line x1="90" y1="30" x2="60" y2="60" stroke-dasharray="5,5">
                            <animate attributeName="stroke-dashoffset" values="10;0" dur="2s" repeatCount="indefinite"/>
                        </line>
                        <line x1="30" y1="90" x2="60" y2="60" stroke-dasharray="5,5">
                            <animate attributeName="stroke-dashoffset" values="0;10" dur="2.5s" repeatCount="indefinite"/>
                        </line>
                        <line x1="90" y1="90" x2="60" y2="60" stroke-dasharray="5,5">
                            <animate attributeName="stroke-dashoffset" values="10;0" dur="2.5s" repeatCount="indefinite"/>
                        </line>
                    </g>
                    
                    <!-- Privacy shield overlay -->
                    <path d="M60 25 L75 35 L75 55 L60 65 L45 55 L45 35 Z" fill="none" stroke="white" stroke-width="2" opacity="0.3">
                        <animate attributeName="opacity" values="0.1;0.5;0.1" dur="4s" repeatCount="indefinite"/>
                    </path>
                </svg>
            </div>
            <h1 class="main-title">Federated Healthcare AI</h1>
            <p class="subtitle">Privacy-preserving collaborative machine learning across healthcare institutions</p>
            <div class="privacy-badge">
                <span>🔒</span>
                Zero-Knowledge Data Sharing
            </div>
        </header>

        <div class="dashboard">
            <!-- Left Panel: Simulation Controls -->
            <div class="panel">
                <h2 class="panel-title">
                    <div class="panel-icon">⚙️</div>
                    Federation Controls
                </h2>
                
                <div class="simulation-controls">
                    <div class="control-group">
                        <label class="control-label">Number of Institutions</label>
                        <div class="slider-container">
                            <input type="range" id="institutionCount" class="slider" min="3" max="8" value="5">
                            <span class="slider-value" id="institutionValue">5</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label">Training Rounds</label>
                        <div class="slider-container">
                            <input type="range" id="trainingRounds" class="slider" min="10" max="100" value="50">
                            <span class="slider-value" id="roundsValue">50</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label">Privacy Level (ε)</label>
                        <div class="slider-container">
                            <input type="range" id="privacyLevel" class="slider" min="0.1" max="2.0" step="0.1" value="1.0">
                            <span class="slider-value" id="privacyValue">1.0</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label">Data Heterogeneity</label>
                        <div class="slider-container">
                            <input type="range" id="heterogeneity" class="slider" min="0" max="100" value="30">
                            <span class="slider-value" id="heteroValue">30%</span>
                        </div>
                    </div>
                </div>

                <div class="privacy-status">
                    <div class="privacy-header">
                        <div class="privacy-icon">🛡️</div>
                        <span style="font-weight: 600;">Privacy Guarantees</span>
                    </div>
                    <div class="privacy-items">
                        <div class="privacy-item">
                            <div class="privacy-check">✓</div>
                            Differential Privacy Enabled
                        </div>
                        <div class="privacy-item">
                            <div class="privacy-check">✓</div>
                            Secure Aggregation
                        </div>
                        <div class="privacy-item">
                            <div class="privacy-check">✓</div>
                            Zero Raw Data Sharing
                        </div>
                        <div class="privacy-item">
                            <div class="privacy-check">✓</div>
                            Cryptographic Protocols
                        </div>
                    </div>
                </div>

                <div class="federation-controls">
                    <button id="startFederation" class="btn btn-primary">
                        <span>🚀</span>
                        Start Federation
                    </button>
                    <button id="resetSimulation" class="btn btn-secondary">
                        <span>🔄</span>
                        Reset
                    </button>
                </div>
            </div>

            <!-- Center Panel: Visualization -->
            <div class="panel">
                <h2 class="panel-title">
                    <div class="panel-icon">📊</div>
                    Federation Network
                </h2>
                
                <div class="federation-viz">
                    <div class="viz-container">
                        <div class="viz-header">
                            <div class="viz-title">Model Convergence Visualization</div>
                            <div class="viz-controls">
                                <button class="viz-btn active" data-viz="convergence">Convergence</button>
                                <button class="viz-btn" data-viz="privacy">Privacy</button>
                                <button class="viz-btn" data-viz="network">Network</button>
                            </div>
                        </div>
                        
                        <svg class="network-svg" id="federationViz">
                            <!-- Dynamic visualization will be rendered here -->
                        </svg>
                    </div>
                </div>

                <!-- Training Status -->
                <div id="trainingStatus" class="training-status">
                    <div class="federation-loader">
                        <div class="loader-ring"></div>
                        <div class="loader-ring"></div>
                        <div class="loader-ring"></div>
                    </div>
                    <div style="font-size: 1.1rem; color: var(--text-muted);">
                        Federated training in progress...
                    </div>
                    <div id="trainingProgress" style="font-size: 0.9rem; color: var(--primary); margin-top: 0.5rem;">
                        Round 0 of 50
                    </div>
                </div>
            </div>

            <!-- Right Panel: Institutions & Metrics -->
            <div class="panel">
                <h2 class="panel-title">
                    <div class="panel-icon">🏥</div>
                    Healthcare Institutions
                </h2>

                <div class="institutions-grid" id="institutionsGrid">
                    <!-- Dynamic institution cards will be populated here -->
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="globalAccuracy">94.7%</div>
                        <div class="metric-label">Global Accuracy</div>
                        <div class="metric-trend trend-up">
                            <span>↗</span> +2.3%
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-value" id="privacyBudget">0.85</div>
                        <div class="metric-label">Privacy Budget (ε)</div>
                        <div class="metric-trend trend-up">
                            <span>🔒</span> Secure
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-value" id="convergenceRound">0</div>
                        <div class="metric-label">Current Round</div>
                        <div class="metric-trend" id="convergenceTrend">
                            <span>⏸</span> Ready
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-value" id="dataPoints">125K</div>
                        <div class="metric-label">Total Data Points</div>
                        <div class="metric-trend">
                            <span>📊</span> Federated
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            <a href="#" class="architecture-link" onclick="showArchitecture()">
                <span>🏗️</span>
                View Federation Architecture
            </a>
        </footer>
    </div>

    <script>
        // Healthcare institutions data
        const healthcareInstitutions = [
            {
                id: 'mgh',
                name: 'Massachusetts General Hospital',
                type: 'Academic Medical Center',
                dataSize: '25,400',
                specialty: 'General Medicine',
                accuracy: '95.2%',
                status: 'active'
            },
            {
                id: 'mayo',
                name: 'Mayo Clinic',
                type: 'Integrated Health System',
                dataSize: '31,200',
                specialty: 'Cardiology',
                accuracy: '94.8%',
                status: 'active'
            },
            {
                id: 'hopkins',
                name: 'Johns Hopkins Hospital',
                type: 'Research Hospital',
                dataSize: '22,100',
                specialty: 'Oncology',
                accuracy: '96.1%',
                status: 'active'
            },
            {
                id: 'cleveland',
                name: 'Cleveland Clinic',
                type: 'Multi-specialty Hospital',
                dataSize: '18,700',
                specialty: 'Cardiovascular',
                accuracy: '93.9%',
                status: 'active'
            },
            {
                id: 'stanford',
                name: 'Stanford Health Care',
                type: 'Academic Medical Center',
                dataSize: '27,800',
                specialty: 'Neurology',
                accuracy: '95.7%',
                status: 'active'
            },
            {
                id: 'msk',
                name: 'Memorial Sloan Kettering',
                type: 'Cancer Center',
                dataSize: '15,300',
                specialty: 'Oncology',
                accuracy: '97.2%',
                status: 'active'
            },
            {
                id: 'cedars',
                name: 'Cedars-Sinai Medical Center',
                type: 'Academic Medical Center',
                dataSize: '21,600',
                specialty: 'Emergency Medicine',
                accuracy: '94.3%',
                status: 'active'
            },
            {
                id: 'partners',
                name: 'Partners HealthCare',
                type: 'Health System',
                dataSize: '33,900',
                specialty: 'Primary Care',
                accuracy: '93.1%',
                status: 'active'
            }
        ];

        // DOM elements
        const institutionCountSlider = document.getElementById('institutionCount');
        const trainingRoundsSlider = document.getElementById('trainingRounds');
        const privacyLevelSlider = document.getElementById('privacyLevel');
        const heterogeneitySlider = document.getElementById('heterogeneity');
        
        const institutionValue = document.getElementById('institutionValue');
        const roundsValue = document.getElementById('roundsValue');
        const privacyValue = document.getElementById('privacyValue');
        const heteroValue = document.getElementById('heteroValue');
        
        const institutionsGrid = document.getElementById('institutionsGrid');
        const startFederationBtn = document.getElementById('startFederation');
        const resetSimulationBtn = document.getElementById('resetSimulation');
        const trainingStatus = document.getElementById('trainingStatus');
        const trainingProgress = document.getElementById('trainingProgress');
        const federationViz = document.getElementById('federationViz');
        
        // Metrics elements
        const globalAccuracy = document.getElementById('globalAccuracy');
        const privacyBudget = document.getElementById('privacyBudget');
        const convergenceRound = document.getElementById('convergenceRound');
        const convergenceTrend = document.getElementById('convergenceTrend');
        const dataPoints = document.getElementById('dataPoints');

        let currentSimulation = null;
        let isTraining = false;
        let currentRound = 0;
        let maxRounds = 50;
        let selectedInstitutions = [];

        // Initialize slider event listeners
        institutionCountSlider.addEventListener('input', function() {
            institutionValue.textContent = this.value;
            updateInstitutionsDisplay();
        });

        trainingRoundsSlider.addEventListener('input', function() {
            roundsValue.textContent = this.value;
            maxRounds = parseInt(this.value);
        });

        privacyLevelSlider.addEventListener('input', function() {
            privacyValue.textContent = this.value;
            updatePrivacyVisualization();
        });

        heterogeneitySlider.addEventListener('input', function() {
            heteroValue.textContent = this.value + '%';
            updateHeterogeneityVisualization();
        });

        // Visualization controls
        document.querySelectorAll('.viz-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.viz-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                updateVisualization(this.dataset.viz);
            });
        });

        // Federation controls
        startFederationBtn.addEventListener('click', startFederatedTraining);
        resetSimulationBtn.addEventListener('click', resetSimulation);

        function updateInstitutionsDisplay() {
            const count = parseInt(institutionCountSlider.value);
            selectedInstitutions = healthcareInstitutions.slice(0, count);
            
            institutionsGrid.innerHTML = '';
            
            selectedInstitutions.forEach((institution, index) => {
                const card = document.createElement('div');
                card.className = 'institution-card';
                card.innerHTML = `
                    <div class="institution-header">
                        <div class="institution-name">${institution.name}</div>
                        <div class="institution-status"></div>
                    </div>
                    <div class="institution-metrics">
                        <div>Data: ${institution.dataSize}</div>
                        <div>Acc: ${institution.accuracy}</div>
                        <div style="grid-column: 1/-1; margin-top: 0.25rem; font-size: 0.75rem;">${institution.specialty}</div>
                    </div>
                `;
                institutionsGrid.appendChild(card);
            });

            // Update total data points
            const totalData = selectedInstitutions.reduce((sum, inst) => {
                return sum + parseInt(inst.dataSize.replace(',', ''));
            }, 0);
            dataPoints.textContent = (totalData / 1000).toFixed(0) + 'K';
            
            updateNetworkVisualization();
        }

        function updateVisualization(type) {
            const svg = federationViz;
            svg.innerHTML = '';
            
            const width = svg.clientWidth || 600;
            const height = svg.clientHeight || 400;
            
            switch(type) {
                case 'convergence':
                    drawConvergenceChart(svg, width, height);
                    break;
                case 'privacy':
                    drawPrivacyVisualization(svg, width, height);
                    break;
                case 'network':
                    drawNetworkVisualization(svg, width, height);
                    break;
            }
        }

        function drawConvergenceChart(svg, width, height) {
            // Clear existing content
            svg.innerHTML = '';
            
            // Create a cute "coming soon" message
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            svg.appendChild(g);

            // Background
            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            bg.setAttribute('width', width);
            bg.setAttribute('height', height);
            bg.setAttribute('fill', 'rgba(0, 0, 0, 0.1)');
            bg.setAttribute('rx', '12');
            g.appendChild(bg);

            // Cute robot icon
            const robot = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            robot.setAttribute('x', width / 2);
            robot.setAttribute('y', height / 2 - 20);
            robot.setAttribute('text-anchor', 'middle');
            robot.setAttribute('font-size', '48');
            robot.textContent = '🤖';
            g.appendChild(robot);

            // Coming soon text
            const text1 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text1.setAttribute('x', width / 2);
            text1.setAttribute('y', height / 2 + 20);
            text1.setAttribute('text-anchor', 'middle');
            text1.setAttribute('fill', 'rgba(255,255,255,0.8)');
            text1.setAttribute('font-size', '18');
            text1.setAttribute('font-weight', 'bold');
            text1.textContent = 'Convergence Visualization';
            g.appendChild(text1);

            const text2 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text2.setAttribute('x', width / 2);
            text2.setAttribute('y', height / 2 + 45);
            text2.setAttribute('text-anchor', 'middle');
            text2.setAttribute('fill', 'rgba(255,255,255,0.6)');
            text2.setAttribute('font-size', '14');
            text2.textContent = 'Coming Soon! 🚀';
            g.appendChild(text2);

            // Animated dots
            for (let i = 0; i < 3; i++) {
                const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                dot.setAttribute('cx', width / 2 - 20 + i * 20);
                dot.setAttribute('cy', height / 2 + 70);
                dot.setAttribute('r', '3');
                dot.setAttribute('fill', '#00ff94');
                dot.setAttribute('opacity', '0.5');
                
                const animate = document.createElementNS('http://www.w3.org/2000/svg', 'animate');
                animate.setAttribute('attributeName', 'opacity');
                animate.setAttribute('values', '0.5;1;0.5');
                animate.setAttribute('dur', '1.5s');
                animate.setAttribute('begin', `${i * 0.5}s`);
                animate.setAttribute('repeatCount', 'indefinite');
                dot.appendChild(animate);
                
                g.appendChild(dot);
            }
        }

        function drawPrivacyVisualization(svg, width, height) {
            // Clear existing content
            svg.innerHTML = '';
            
            const centerX = width / 2;
            const centerY = height / 2;

            // Background
            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            bg.setAttribute('width', width);
            bg.setAttribute('height', height);
            bg.setAttribute('fill', 'rgba(0, 0, 0, 0.1)');
            bg.setAttribute('rx', '12');
            svg.appendChild(bg);

            // Cute lock icon
            const lock = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            lock.setAttribute('x', centerX);
            lock.setAttribute('y', centerY - 20);
            lock.setAttribute('text-anchor', 'middle');
            lock.setAttribute('font-size', '48');
            lock.textContent = '🔐';
            svg.appendChild(lock);

            // Privacy level display
            const privacyLevel = parseFloat(privacyLevelSlider.value);
            const privacyText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            privacyText.setAttribute('x', centerX);
            privacyText.setAttribute('y', centerY + 20);
            privacyText.setAttribute('text-anchor', 'middle');
            privacyText.setAttribute('fill', '#00ff94');
            privacyText.setAttribute('font-size', '24');
            privacyText.setAttribute('font-weight', 'bold');
            privacyText.textContent = `ε = ${privacyLevel}`;
            svg.appendChild(privacyText);

            // Coming soon text
            const text1 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text1.setAttribute('x', centerX);
            text1.setAttribute('y', centerY + 50);
            text1.setAttribute('text-anchor', 'middle');
            text1.setAttribute('fill', 'rgba(255,255,255,0.8)');
            text1.setAttribute('font-size', '16');
            text1.textContent = 'Privacy Budget Visualization';
            svg.appendChild(text1);

            const text2 = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text2.setAttribute('x', centerX);
            text2.setAttribute('y', centerY + 75);
            text2.setAttribute('text-anchor', 'middle');
            text2.setAttribute('fill', 'rgba(255,255,255,0.6)');
            text2.setAttribute('font-size', '12');
            text2.textContent = 'Enhanced charts coming soon! 🛡️';
            svg.appendChild(text2);

            // Floating privacy particles
            for (let i = 0; i < 5; i++) {
                const particle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                particle.setAttribute('cx', centerX + (Math.random() - 0.5) * 200);
                particle.setAttribute('cy', centerY + (Math.random() - 0.5) * 150);
                particle.setAttribute('r', '2');
                particle.setAttribute('fill', 'rgba(0, 255, 148, 0.6)');
                
                const animateY = document.createElementNS('http://www.w3.org/2000/svg', 'animateTransform');
                animateY.setAttribute('attributeName', 'transform');
                animateY.setAttribute('type', 'translate');
                animateY.setAttribute('values', '0,0; 0,-10; 0,0');
                animateY.setAttribute('dur', `${2 + Math.random() * 2}s`);
                animateY.setAttribute('repeatCount', 'indefinite');
                particle.appendChild(animateY);
                
                svg.appendChild(particle);
            }
        }

        function drawNetworkVisualization(svg, width, height) {
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 3;

            // Central aggregator
            const central = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            central.setAttribute('cx', centerX);
            central.setAttribute('cy', centerY);
            central.setAttribute('r', '20');
            central.setAttribute('fill', '#00ff94');
            central.setAttribute('stroke', 'white');
            central.setAttribute('stroke-width', '3');
            svg.appendChild(central);

            // Central label
            const centralLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            centralLabel.setAttribute('x', centerX);
            centralLabel.setAttribute('y', centerY + 5);
            centralLabel.setAttribute('text-anchor', 'middle');
            centralLabel.setAttribute('fill', 'white');
            centralLabel.setAttribute('font-size', '12');
            centralLabel.setAttribute('font-weight', 'bold');
            centralLabel.textContent = 'AGG';
            svg.appendChild(centralLabel);

            // Institution nodes
            selectedInstitutions.forEach((institution, i) => {
                const angle = (2 * Math.PI * i) / selectedInstitutions.length;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                // Connection line
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', centerX);
                line.setAttribute('y1', centerY);
                line.setAttribute('x2', x);
                line.setAttribute('y2', y);
                line.setAttribute('stroke', 'rgba(0, 212, 255, 0.5)');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('stroke-dasharray', '5,5');
                svg.appendChild(line);

                // Institution node
                const node = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                node.setAttribute('cx', x);
                node.setAttribute('cy', y);
                node.setAttribute('r', '15');
                node.setAttribute('fill', '#00d4ff');
                node.setAttribute('stroke', 'white');
                node.setAttribute('stroke-width', '2');
                svg.appendChild(node);

                // Institution label
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', x);
                label.setAttribute('y', y + 35);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('fill', 'rgba(255,255,255,0.8)');
                label.setAttribute('font-size', '11');
                label.textContent = institution.name.split(' ')[0];
                svg.appendChild(label);
            });

            // Title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', centerX);
            title.setAttribute('y', 30);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('fill', 'rgba(255,255,255,0.7)');
            title.setAttribute('font-size', '16');
            title.textContent = 'Federated Learning Network Topology';
            svg.appendChild(title);
        }

        function updateNetworkVisualization() {
            updateVisualization('network');
        }

        function updatePrivacyVisualization() {
            if (document.querySelector('.viz-btn[data-viz="privacy"]').classList.contains('active')) {
                updateVisualization('privacy');
            }
        }

        function updateHeterogeneityVisualization() {
            // Update visualization based on heterogeneity if needed
        }

        function startFederatedTraining() {
            if (isTraining) return;

            isTraining = true;
            currentRound = 0;
            startFederationBtn.disabled = true;
            startFederationBtn.innerHTML = '<span>⏸</span> Training...';
            trainingStatus.style.display = 'block';
            convergenceTrend.innerHTML = '<span>🔄</span> Training';

            simulateFederatedRounds();
        }

        function simulateFederatedRounds() {
            const interval = setInterval(() => {
                currentRound++;
                trainingProgress.textContent = `Round ${currentRound} of ${maxRounds}`;
                convergenceRound.textContent = currentRound;

                // Update global accuracy
                const baseAccuracy = 85;
                const maxImprovement = 10;
                const accuracy = baseAccuracy + (maxImprovement * (1 - Math.exp(-currentRound / 15))) + Math.random() * 1 - 0.5;
                globalAccuracy.textContent = accuracy.toFixed(1) + '%';

                // Update privacy budget
                const privacyUsed = currentRound / maxRounds * parseFloat(privacyLevelSlider.value);
                privacyBudget.textContent = (parseFloat(privacyLevelSlider.value) - privacyUsed).toFixed(2);

                // Update visualization
                if (document.querySelector('.viz-btn[data-viz="convergence"]').classList.contains('active')) {
                    updateVisualization('convergence');
                }

                if (currentRound >= maxRounds) {
                    clearInterval(interval);
                    completeFederatedTraining();
                }
            }, 300);
        }

        function completeFederatedTraining() {
            isTraining = false;
            startFederationBtn.disabled = false;
            startFederationBtn.innerHTML = '<span>✅</span> Training Complete';
            trainingStatus.style.display = 'none';
            convergenceTrend.innerHTML = '<span>✅</span> Converged';
            
            setTimeout(() => {
                startFederationBtn.innerHTML = '<span>🚀</span> Start Federation';
            }, 3000);
        }

        function resetSimulation() {
            if (isTraining) return;

            currentRound = 0;
            convergenceRound.textContent = '0';
            globalAccuracy.textContent = '94.7%';
            privacyBudget.textContent = privacyLevelSlider.value;
            convergenceTrend.innerHTML = '<span>⏸</span> Ready';
            trainingStatus.style.display = 'none';
            
            updateVisualization('convergence');
        }

        function showArchitecture() {
            // Create modal overlay
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 2rem;
                animation: modalFadeIn 0.3s ease;
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: var(--surface);
                border: 1px solid var(--border);
                border-radius: 24px;
                padding: 3rem;
                max-width: 900px;
                max-height: 80vh;
                overflow-y: auto;
                position: relative;
                backdrop-filter: blur(20px);
                box-shadow: var(--glow-primary);
            `;

            modalContent.innerHTML = `
                <button id="closeModal" style="
                    position: absolute;
                    top: 1rem;
                    right: 1rem;
                    background: none;
                    border: none;
                    color: var(--text);
                    font-size: 1.5rem;
                    cursor: pointer;
                    padding: 0.5rem;
                    border-radius: 50%;
                    transition: background 0.3s ease;
                " onmouseover="this.style.background='var(--surface-2)'" onmouseout="this.style.background='none'">✕</button>

                <h2 style="
                    font-size: 2.2rem;
                    margin-bottom: 2rem;
                    background: var(--federation-gradient);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                ">🏗️ Federated Learning Architecture</h2>

                <div style="display: grid; gap: 2rem;">
                    <div style="background: var(--surface-2); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--primary);">
                        <h3 style="color: var(--primary); margin-bottom: 1rem;">🔹 Privacy-Preserving Training</h3>
                        <ul style="color: var(--text-muted); line-height: 1.8;">
                            <li><strong>Differential Privacy:</strong> Mathematical guarantees for data protection</li>
                            <li><strong>Secure Aggregation:</strong> Cryptographic protocols for model updates</li>
                            <li><strong>Zero Raw Data Sharing:</strong> Only model parameters are exchanged</li>
                            <li><strong>Local Training:</strong> Each institution trains on local data only</li>
                        </ul>
                    </div>

                    <div style="background: var(--surface-2); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--secondary);">
                        <h3 style="color: var(--secondary); margin-bottom: 1rem;">🔹 Federation Protocol</h3>
                        <ul style="color: var(--text-muted); line-height: 1.8;">
                            <li><strong>FedAvg Algorithm:</strong> Weighted averaging of model parameters</li>
                            <li><strong>Adaptive Learning:</strong> Dynamic learning rate adjustment</li>
                            <li><strong>Byzantine Fault Tolerance:</strong> Robust against malicious participants</li>
                            <li><strong>Convergence Monitoring:</strong> Real-time performance tracking</li>
                        </ul>
                    </div>

                    <div style="background: var(--surface-2); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--accent);">
                        <h3 style="color: var(--accent); margin-bottom: 1rem;">🔹 Healthcare Applications</h3>
                        <ul style="color: var(--text-muted); line-height: 1.8;">
                            <li><strong>Medical Imaging:</strong> Collaborative diagnosis model training</li>
                            <li><strong>Electronic Health Records:</strong> Predictive analytics across institutions</li>
                            <li><strong>Drug Discovery:</strong> Molecular property prediction</li>
                            <li><strong>Epidemiology:</strong> Disease outbreak pattern recognition</li>
                        </ul>
                    </div>

                    <div style="background: var(--surface-2); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--warning);">
                        <h3 style="color: var(--warning); margin-bottom: 1rem;">🔹 Technology Stack</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; color: var(--text-muted);">
                            <div>
                                <strong>Core Framework:</strong><br>
                                • TensorFlow Federated<br>
                                • PyTorch + PySyft<br>
                                • Differential Privacy Library<br>
                                • Cryptographic Protocols
                            </div>
                            <div>
                                <strong>Infrastructure:</strong><br>
                                • Kubernetes Orchestration<br>
                                • gRPC Communication<br>
                                • MongoDB Data Storage<br>
                                • Docker Containerization
                            </div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(0, 255, 148, 0.1), rgba(0, 255, 148, 0.05)); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(0, 255, 148, 0.3);">
                        <h3 style="color: var(--primary); margin-bottom: 1rem;">🔒 Compliance & Ethics</h3>
                        <p style="color: var(--text-muted); line-height: 1.6;">
                            This federated learning system ensures compliance with HIPAA, GDPR, and other healthcare 
                            data protection regulations. All training occurs locally with mathematical privacy guarantees, 
                            enabling collaborative AI development while maintaining the highest standards of patient 
                            data protection and institutional autonomy.
                        </p>
                    </div>
                </div>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);

            // Close modal functionality
            document.getElementById('closeModal').addEventListener('click', () => {
                modal.style.animation = 'modalFadeOut 0.3s ease forwards';
                setTimeout(() => document.body.removeChild(modal), 300);
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.animation = 'modalFadeOut 0.3s ease forwards';
                    setTimeout(() => document.body.removeChild(modal), 300);
                }
            });

            // Add modal animations if not already present
            if (!document.querySelector('#modalAnimations')) {
                const modalStyle = document.createElement('style');
                modalStyle.id = 'modalAnimations';
                modalStyle.textContent = `
                    @keyframes modalFadeIn {
                        from { opacity: 0; transform: scale(0.9); }
                        to { opacity: 1; transform: scale(1); }
                    }
                    @keyframes modalFadeOut {
                        from { opacity: 1; transform: scale(1); }
                        to { opacity: 0; transform: scale(0.9); }
                    }
                `;
                document.head.appendChild(modalStyle);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateInstitutionsDisplay();
            updateVisualization('convergence');
        });
    </script>
</body>
</html>